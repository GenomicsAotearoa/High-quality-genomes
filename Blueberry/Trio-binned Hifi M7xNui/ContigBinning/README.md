## Assigning contigs to haplotypes. 


### HiFiasm does not correctly phase haplotypes. We can think of each of the haplytpes generated by HiFiasm and a chimaric combination of contigs (which are correctly phased). 
From the manual: 
>Since v0.15, hifiasm produces two sets of partially phased contigs in default like:
>
>hifiasm -o NA12878.asm -t 32 NA12878.fq.gz
>In this example, the partially phased contigs are written to NA12878.asm.bp.hap*.p_ctg.gfa. This pair of files can be thought to represent the two haplotypes in a >diploid genome, though with occasional switch errors. 

## Data:
+ illumina Data from Parents
+ HiFi Data from Progeny triobinned into M7 and Nui Hifi reads
+ Partially phased contigs produced by hifiasm from each of the binned HiFi reads (M7 partially phased diploid assembly, Nui partially phased diploid assembly from M7xNui allotetraploid progeny)
+ High density linkage map for each of the tetraploid parents (8 haplotypes) and the allele dosage of the progeny. 

## PLAN:
#### Need to *fully* phase the diploid assemblies . 
+ Pick out the simplex SNPs from the linkage map (the SNPs that have the alternative allele for *only* one of the 8 parental haplotypes)
+ Score the contigs. Give each contig a score of how many times the contig matches up with each of the parental haplotypes. 
+ use the score to flag or bin contigs into the haplotypes. 
+ Use the fully phased contigs to do synteny mapping check. Plot as a dotplot. 
+ Identify which haplotype is the causative variant. 